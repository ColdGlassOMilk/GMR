# Project Structure

How to organize your GMR game project.

## Default Structure

A new GMR project has this structure:

```
my-game/
├── game/
│   ├── scripts/
│   │   ├── main.rb      # Main game script (required)
│   │   └── util.rb      # Utility functions (optional)
│   └── assets/
│       ├── images/      # PNG, JPG, etc.
│       ├── sounds/      # WAV, OGG, MP3
│       └── data/        # JSON, custom files
├── build/               # Debug build output (auto-generated)
├── build-release/       # Release build output (auto-generated)
└── build-web/           # Web build output (auto-generated)
```

## Required Files

### game/scripts/main.rb

The main entry point. Must define at least:

```ruby
def init
  # Initialization code
end

def update(dt)
  # Game logic
end

def draw
  # Rendering
end
```

## Scripts Directory

All `.rb` files in `game/scripts/` are automatically loaded.

### Load Order

1. `util.rb` (if exists)
2. `main.rb`
3. Other `.rb` files (alphabetically)

### Organizing Multiple Scripts

For larger games, split code into multiple files:

```
game/scripts/
├── main.rb          # Entry point, game loop
├── util.rb          # Shared utilities
├── player.rb        # Player class/functions
├── enemy.rb         # Enemy class/functions
├── level.rb         # Level loading
└── ui.rb            # UI rendering
```

Example structure:

```ruby
# player.rb
class Player
  attr_accessor :x, :y, :health

  def initialize(x, y)
    @x, @y = x, y
    @health = 100
  end

  def update(dt)
    # Player logic
  end

  def draw
    Graphics.draw_rect(@x - 16, @y - 16, 32, 32, [100, 200, 255])
  end
end
```

```ruby
# main.rb
include GMR

def init
  $player = Player.new(400, 300)
end

def update(dt)
  return if console_open?
  $player.update(dt)
end

def draw
  Graphics.clear([30, 30, 40])
  $player.draw
end
```

## Assets Directory

### Images

Place image files in `game/assets/`:

```ruby
# Load from assets root
$sprite = Graphics::Texture.load("assets/player.png")

# Or organize in subdirectories
$sprite = Graphics::Texture.load("assets/images/player.png")
```

**Supported formats:** PNG, JPG, BMP, GIF

### Sounds

```ruby
$music = Audio::Sound.load("assets/sounds/music.ogg")
$jump = Audio::Sound.load("assets/sounds/jump.wav")
```

**Supported formats:** WAV, OGG, MP3

### Data Files

For level data, configuration, etc.:

```
game/assets/
└── data/
    ├── levels/
    │   ├── level1.json
    │   └── level2.json
    └── config.json
```

**Note:** GMR doesn't have built-in file reading for data files. Use hardcoded data or embed in scripts.

## Build Output

Build directories are auto-generated:

| Directory | Purpose | Generated by |
|-----------|---------|--------------|
| `build/` | Debug build | `gmrcli build debug` |
| `build-release/` | Release build | `gmrcli build release` |
| `build-web/` | Web build | `gmrcli build web` |

These directories can be safely deleted (they'll be recreated on build).

### .gitignore

Add to your `.gitignore`:

```
build/
build-release/
build-web/
*.exe
*.mrb
```

## Example: Larger Game Structure

```
space-shooter/
├── game/
│   ├── scripts/
│   │   ├── main.rb           # Entry point
│   │   ├── util.rb           # Utilities
│   │   ├── entities/
│   │   │   ├── player.rb     # Note: subdirs don't work
│   │   │   └── enemy.rb      # Keep all .rb in scripts/
│   │   ├── player.rb         # Player logic
│   │   ├── enemy.rb          # Enemy logic
│   │   ├── bullet.rb         # Projectiles
│   │   ├── powerup.rb        # Power-ups
│   │   ├── collision.rb      # Collision handling
│   │   ├── spawner.rb        # Enemy spawning
│   │   ├── ui.rb             # HUD, menus
│   │   └── constants.rb      # Shared constants
│   └── assets/
│       ├── sprites/
│       │   ├── player.png
│       │   ├── enemy1.png
│       │   └── bullets.png
│       ├── sounds/
│       │   ├── shoot.wav
│       │   ├── explosion.wav
│       │   └── music.ogg
│       └── ui/
│           └── font.png
├── .gitignore
└── README.md
```

**Important:** Script subdirectories are NOT supported. All `.rb` files must be directly in `game/scripts/`.

## Tips

1. **Start simple** - Use just `main.rb` until you need more
2. **Global variables** - Use `$var` for state that spans files
3. **Classes for entities** - Define Player, Enemy classes in separate files
4. **Constants file** - Put shared constants (screen size, speeds) in one place
5. **Flat script structure** - No subdirectories in scripts/

## See Also

- [Getting Started](../getting-started.md) - First project setup
- [Bytecode](bytecode.md) - How scripts are compiled
- [CLI Commands](../cli/README.md) - Build and run
